---
import Layout from "../../layouts/Layout.astro";
import ImageCarousel from "../../components/ImageCarousel.jsx";
import ImageCarouselExtras from "../../components/ImageCarouselExtras.jsx";
import KeycapButtons from "../../components/KeycapButtons.jsx";
import PriceTable from "../../components/PriceTable.astro";
import ColorBlock from "../../components/ColorBlock.astro";

import data from "../../../public/data.json";

const { id } = Astro.params;
const response = data.keycaps.filter((item)=>{
  return id === item.id;
})
---

<Layout title="Keycap demo">
  <main>
    <div class="keycap-info-wrapper">
  
    <section class="keycap-info-container">


      
        <div class="keycap-carousel-container">
          <ImageCarousel client:load kits={response[0].attributes.kits} id={id} />
        </div>
        <div class="keycap-main-info-container">
          <div>
            <h2 class="text-3xl">{response[0].attributes.manufacturer + " " + response[0].attributes.title}</h2>
            <div class="keycap-tags-container">
              <div>
                <p class="text-small text-bold">Designed by</p>
                <p class="text-small">{response[0].attributes.designer}</p>
              </div>
              <div>
                <p class="text-small text-bold">Group buy</p>
                <p class="text-small">
                  {response[0].attributes.dates.groupBuy}
                </p>
              </div>
              <div>
                <p class="text-small text-bold">Shipped</p>
                <p class="text-small">{response[0].attributes.dates.shipped}</p>
              </div>
            </div>
          </div>
          <p class="text-base">{response[0].attributes.description}</p>
          <div>
            <h3 class="text-xl">Kits</h3>
            <KeycapButtons client:load kits={response[0].attributes.kits} />
          </div>

          <div>
            <h3 class="text-xl">Colors</h3>
            <ColorBlock colors={response[0].attributes.colors} />
          </div>

          <div>
            <h3 class="text-xl">Pricing</h3>
            {
              Object.keys(response[0].attributes.kits[0].price).length !== 0 ? (
                <PriceTable kits={response[0].attributes.kits} />
              ) : (
                <p class="text-base">No pricing available.</p>
              )
            }
          </div>
        </div>
      </section>
      <section class="keycap-extras-container">
        {response[0].attributes.deskmats.length !==0 && 
          <div>
            <h3 class="text-xl">Deskmats</h3>
            <ImageCarouselExtras
              client:load
              extras={response[0].attributes.deskmats}
              element="deskmats"
            />
          </div>}
        {response[0].attributes.collabs.length !==0 && 
          <div>
            <h3 class="text-xl">Collabs</h3>
            <ImageCarouselExtras
              client:load
              extras={response[0].attributes.collabs}
              element="collabs"
            />
          </div>}
        
        {response[0].attributes.renders.length !==0 && 
          <div>
            <h3 class="text-xl">Renders</h3>
            <ImageCarouselExtras
              client:load
              extras={response[0].attributes.renders}
              element="renders"
            />
          </div>}
      </section>
      <section class="reference-container">
        <p>Reference:</p>
        <a href={response[0].attributes.groupBuyLink} class="reference-link"
          >Link</a
        >
      </section> 
    </div>
  </main>
</Layout>
  <style>
    .keycap-info-wrapper {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
     {
      padding-bottom: 0.5rem;
    }

    .keycap-tags-container {
      display: flex;
      gap: 2rem;
      color: grey;
    }

    .keycap-info-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .keycap-main-info-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      flex: 1;
    }

    .keycap-carousel-container {
      display: flex;
      justify-content: center;
    }

    /* EXTRAS */
    .keycap-extras-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    /* REFERENCE */
    .reference-container {
      display: flex;
      font-size: 1rem;
      gap: 0.25rem;
    }
    .reference-link {
      color: blue;
      /* text-decoration: underline; */
    }

    @media (min-width: 640px) {
    }

    @media (min-width: 768px) {
      .keycap-info-container {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .keycap-extras-container {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }

      .keycap-carousel-container {
        order: 1;
      }
    }
  </style>

